# Hostapd Configuration for wlanpi-profiler
# Band: 2.4 GHz
# Generated: {{ generation_timestamp }}

# Interface Configuration
interface={{ interface }}
driver=nl80211
ctrl_interface=/var/run/wlanpi-profiler/hostapd
ctrl_interface_group=0

# Basic AP Parameters
ssid={{ ssid }}
hw_mode={{ hw_mode }}
channel={{ channel }}
country_code={{ country_code }}
beacon_int=102
beacon_rate=120

# Security Configuration
wpa=2
wpa_key_mgmt={{ wpa_key_mgmt }}

{% if wpa3_enabled %}
sae_password={{ passphrase }}
sae_pwe=2
{% endif %}
wpa_passphrase={{ passphrase }}
{% if wpa3_enabled %}
wpa_pairwise=CCMP GCMP
rsn_pairwise=CCMP GCMP
{% else %}
wpa_pairwise=CCMP
rsn_pairwise=CCMP
{% endif %}

# 802.11w (Management Frame Protection)
ieee80211w=1

# Interworking (802.11u) for comprehensive capability advertising
interworking=1
access_network_type=0
internet=1

{% if ft_enabled %}
# 802.11r (Fast Transition)
nas_identifier=wlanpi-profiler.local
mobility_domain={{ mobility_domain }}
ft_over_ds=0
ft_psk_generate_local=1
pmk_r1_push=0
reassociation_deadline=1000

{% endif %}
# HT Capabilities (802.11n)
{% if ieee80211n_enabled %}
ieee80211n=1
ht_capab=[LDPC][SHORT-GI-20][TX-STBC][RX-STBC1][MAX-AMSDU-7935]
{% else %}
ieee80211n=0
{% endif %}

# VHT NOT supported in 2.4 GHz (802.11ac is 5 GHz only)
ieee80211ac=0

# HE Capabilities (802.11ax / Wi-Fi 6)
{% if ieee80211ax_enabled %}
ieee80211ax=1
he_su_beamformer=1
he_mu_beamformer=1
he_oper_chwidth={{ he_oper_chwidth }}
he_oper_centr_freq_seg0_idx={{ he_oper_centr_freq_seg0_idx }}

# HE Spatial Reuse Parameter Set
he_spr_sr_control=5
he_spr_non_srg_obss_pd_max_offset=20
{% else %}
ieee80211ax=0
{% endif %}

# EHT Capabilities (802.11be / Wi-Fi 7)
{% if ieee80211be_enabled %}
ieee80211be=1
eht_su_beamformer=1
eht_su_beamformee=1
eht_mu_beamformer=1
eht_oper_chwidth={{ eht_oper_chwidth }}
eht_oper_centr_freq_seg0_idx={{ eht_oper_centr_freq_seg0_idx }}

# AP MLD (Multi-Link Device) - Enable to advertise MLE even on single-band AP
# This allows profiling Wi-Fi 7 clients' full MLE capabilities
mld_ap=1
{% else %}
ieee80211be=0
{% endif %}

# 802.11k/v
rrm_neighbor_report=1
rrm_beacon_report=1
bss_transition=1

# WMM
wmm_enabled=1

# Vendor-Specific Information Element
# OUI: 31:41:59 (Ï€ digits) - WLAN Pi Profiler version advertisement
# Format: DD<len>314159<data> where data contains TLVs for profiler/system version
# This allows clients to see the profiler version in beacon frames
{% if vendor_elements %}
vendor_elements={{ vendor_elements }}
{% endif %}

# Logging
logger_stdout=-1
logger_stdout_level=2
